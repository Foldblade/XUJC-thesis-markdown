> æ³¨æ„ï¼šæ‚¨å¿…é¡»åœ¨æ–‡æ¡£æœ€å‰ç«¯æ”¾ç½®ä¸€ä¸ª \newSectionInNewPageã€‚
>
> Pandoc ä¼šè‡ªåŠ¨åœ¨ç›®æ ‡ docx å¼€ç«¯ç”Ÿæˆå…ƒæ•°æ®å†…å®¹ï¼ŒåŒ…å«æ ‡é¢˜ã€ä½œè€…ã€æ‘˜è¦å…³é”®å­—ç­‰ï¼Œæ ¹æ® Pandoc æ–‡æ¡£ä¸ issueï¼Œå¹¶æ²¡æœ‰æä¾›å¯¹åº”å…³é—­ç”Ÿæˆçš„é€‰é¡¹ã€‚
>
> å› æ­¤ï¼Œæˆ‘ä»¬ä¼šåœ¨åå¤„ç†è¿‡ç¨‹ä¸­ï¼Œåˆ é™¤æ–‡æ¡£ç¬¬ä¸€ä¸ª \newSectionInNewPage æœ¬èº«ï¼ŒåŠå…¶ä¹‹å‰çš„æ‰€æœ‰å†…å®¹ã€‚

\newSectionInNewPage

\cover

\statementOfOriginality

\abstract

\pageBreak

\abstractEn

\pageBreak

[TOC]

# å¼•è¨€ {.unnumbered}

Markdown æ˜¯ä¸€ç§è½»é‡çº§æ ‡è®°è¯­è¨€ï¼Œæ’ç‰ˆè¯­æ³•ç®€æ´ï¼Œè®©äººä»¬æ›´å¤šåœ°å…³æ³¨å†…å®¹æœ¬èº«è€Œéæ’ç‰ˆã€‚è€Œ Word æ’ç‰ˆåˆ™å¸¸å¸¸éœ€è¦åå¤è°ƒæ•´ã€æ‰“ä¹±å†™ä½œèŠ‚å¥ã€‚åŸºäºè¿™ä¸€ç°çŠ¶ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€å¥—åŸºäº Pandoc ä¸ Python çš„ XUJC æ¯•ä¸šè®ºæ–‡è§£å†³æ–¹æ¡ˆï¼Œè¯¥è§£å†³æ–¹æ¡ˆèƒ½ä¸ºæ‚¨æä¾› Markdown åˆ°ç¬¦åˆæ’ç‰ˆè§„èŒƒçš„ docx æ ¼å¼æ¯•ä¸šè®ºæ–‡çš„ä¸€ç«™å¼å¼€ç®±å³ç”¨ä½“éªŒã€‚

\pageBreak

# ç»ªè®º

## ç ”ç©¶ç°çŠ¶

æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæœ‰äººä¸º XMU åˆ¶ä½œäº†ç›¸åº”çš„ $\LaTeX$ æ¯•ä¸šè®ºæ–‡æ¨¡æ¿ã€‚ç„¶è€Œï¼Œæˆ‘å¹¶æ²¡æœ‰æ£€ç´¢åˆ°æˆ‘ä»¬å­¦æ ¡çš„ $\LaTeX$ æ¨¡æ¿ã€‚

## æœ¬æ–‡å†…å®¹æ¦‚è¿°

æœ¬æ–‡ä»‹ç»äº†ä¸€ä¸ªåŸºäº Pandoc ä¸ Python çš„ XUJC æ¯•ä¸šè®ºæ–‡è§£å†³æ–¹æ¡ˆã€‚è¯¥è§£å†³æ–¹æ¡ˆèƒ½ä¸ºæ‚¨æä¾› Markdown åˆ°ç¬¦åˆæ’ç‰ˆè§„èŒƒçš„ docx æ ¼å¼æ¯•ä¸šè®ºæ–‡çš„ä¸€ç«™å¼å¼€ç®±å³ç”¨ä½“éªŒã€‚

## å¦è¯·æ³¨æ„

è¯¥ Markdown æ—¨åœ¨ä»¤è¯»è€…äº†è§£æœ¬é¡¹ç›®çš„å…·ä½“ç»†èŠ‚ï¼Œå…·ä½“å†™æ³•ä»å‚æ‚äº†è®¸å¤šä¸ªäººçš„ Markdown å†™æ³•ä¹ æƒ¯ï¼ŒåŠ ä¹‹æœ‰è®¸å¤šåˆ©äº Pandoc è§£æè€Œæ·»åŠ çš„å†…å®¹ï¼Œå¹¶ä¸ä¿è¯åœ¨æ‰€æœ‰çš„ Markdown ç¼–è¾‘å™¨ä¸­å‡èƒ½æ­£å¸¸è§£æã€é¢„è§ˆã€‚ç¬”è€…æ’°å†™æ—¶ï¼Œé‡‡ç”¨ [Typora](https://typora.io/)ã€‚

# éœ€æ±‚åˆ†æ

1. ä½¿ç”¨ Markdown è¿›è¡Œè®ºæ–‡æ’°å†™ï¼Œå¹¶å¯é€šè¿‡ Git è¿›è¡Œç‰ˆæœ¬æ§åˆ¶
2. è‡ªåŠ¨è¿›è¡Œæ ‡é¢˜ã€å›¾ç‰‡ã€è¡¨æ ¼ã€å…¬å¼ç¼–å·
3. è‡ªåŠ¨ç”Ÿæˆå¼•æ–‡
4. å¿«é€Ÿç”Ÿæˆç¬¦åˆå­¦æ ¡æ’ç‰ˆè¦æ±‚çš„ docx æ–‡æ¡£

# å¼€å§‹ä½¿ç”¨

## ç¯å¢ƒè¦æ±‚

- Pandoc >= 2.13 ï¼ˆæ›´è€ç‰ˆæœ¬æœªç»æµ‹è¯•ï¼‰
- Python 3.x ï¼ˆ>= 3.7ï¼Œæ›´è€ç‰ˆæœ¬æœªç»æµ‹è¯•ï¼‰
- Zoteroï¼Œç”¨äºç®¡ç†æ–‡çŒ®

## å¼€å‘ç¯å¢ƒ

æˆ‘ä»¬çš„å¼€å‘åŠæµ‹è¯•ç¯å¢ƒæ˜¯ï¼š

- Windows 10
- Python 3.7.3
- pandoc 2.18
  Compiled with pandoc-types 1.22.2, texmath 0.12.5, skylighting 0.12.3,
  citeproc 0.7, ipynb 0.2, hslua 2.2.0
  Scripting engine: Lua 5.4

è¯¥é¡¹ç›®æœªç»è¿‡å¤§è§„æ¨¡æµ‹è¯•ï¼Œå¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿æå‡º issueã€‚æˆ‘ä»¬å°†å°½åŠ›è§£ç­”ã€‚

## ç¯å¢ƒæ­å»º

è¯·è‡ªè¡Œå‰å¾€ [Pandoc å®˜ç½‘](https://pandoc.org/installing.html)ã€[Python å®˜ç½‘](https://www.python.org/downloads/)ã€[Zotero å®˜ç½‘](https://www.zotero.org/download/)ä¸‹è½½å®‰è£…ã€‚

âš åŠ¡è¯·æ³¨æ„ï¼ŒPandoc ä¸ Python åº”åŠ å…¥ PATHã€‚å¦‚è‹¥æ‚¨ä»å®˜ç½‘ä¸‹è½½ã€é‡‡ç”¨å®‰è£…åŒ…æ–¹å¼è¿›è¡Œå®‰è£…ï¼ŒPandoc ä¼¼ä¹åº”è¯¥ä¼šé»˜è®¤åŠ å…¥ PATHã€‚å¦‚æ‚¨ä¸æƒ³å°† Pandoc åŠ å…¥ PATHï¼Œè¯·åœ¨è¯¥é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»º `bin` ç›®å½•ï¼Œå†å‰å¾€ [Pandoc Releases é¡µ](https://github.com/jgm/pandoc/releases)è‡ªè¡Œä¸‹è½½é€‚åˆæ‚¨ç³»ç»Ÿç‰ˆæœ¬çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶å°†å¯æ‰§è¡Œæ–‡ä»¶æ”¾åœ¨ `bin` ç›®å½•ä¸­ã€‚åœ¨ Windows ä¸Šï¼Œç›®å½•ç»“æ„çœ‹èµ·æ¥åº”è¯¥ç±»ä¼¼ï¼š

```
â”‚  .gitignore
â”‚  filter.py
â”‚  LICENSE
â”‚  processer.py
â”‚  ç•¥...
â”‚
â”œâ”€bin
â”‚  â”‚  pandoc.exe
â”‚
â”œâ”€ç•¥...
â”‚
â””â”€ç•¥...
```

## å¿«é€Ÿä¸Šæ‰‹

è¿›è¡Œå¿«é€Ÿä¸Šæ‰‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„å†™ä½œç¯å¢ƒå·²ç»æ»¡è¶³å‰æ–‡æ‰€è¿°çš„ç¯å¢ƒè¦æ±‚ã€‚

1. `git clone` æˆ–ä¸‹è½½è¯¥é¡¹ç›®
2. åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…æ‰€éœ€çš„ Python ä¾èµ–ï¼š

```bash
pip install panflute python-docx regex lxml pandoc-fignos pandoc-eqnos pandoc-tablenos
```

3. ä½¿ç”¨ç»ˆç«¯è¿›å…¥è¯¥é¡¹ç›®æ ¹ç›®å½•ï¼Œè¿è¡Œï¼š

```bash
python processer.py -O result.docx -F ./demo/readme.md -M ./demo/metadata.yaml -B ./demo/ref.bib
```

è¯¥å‘½ä»¤å¯èƒ½ä¼šå‡ºç° `[WARNING] Could not convert TeX math \LaTeX, rendering as TeX:` å­—æ ·ï¼ŒDon't panicï¼Œæ¯‹éœ€æƒŠæ…Œï¼Œåªè¦æœ€æœ«ä¸€è¡Œå‡ºç° `Output file:` å³å‘ŠæˆåŠŸâ€”â€”æ‚¨åº”è¯¥å¯ä»¥çœ‹åˆ°ï¼Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ç”Ÿæˆäº†`result.docx`â€”â€”å¿«å»çœ‹çœ‹å§ï¼

# å¦‚ä½•æ’°å†™

æˆ‘ä»¬å»ºè®®æ‚¨åšå¥½ demo ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å¤‡ä»½ï¼Œæœ€å¥½ä¸€å¼€å§‹å°±å¤åˆ¶ä¸€ä»½å‡ºæ¥ï¼Œä»¥å…ä¿®æ”¹è¿‡å¤šå¯¼è‡´è‡ªå·±éƒ½ä¸çŸ¥é“ä¿®æ”¹äº†ä»€ä¹ˆã€‚

å¦‚æœæ‚¨æ²¡æœ‰è¶³å¤Ÿçš„è€å¿ƒé˜…è¯»æ–‡æ¡£ï¼Œæˆ‘ä»¬æ›´å»ºè®®æ‚¨å¤åˆ¶æœ¬æ–‡ä»¶åè¿›è¡Œä¿®æ”¹â€”â€”ä¸”æ—¶å¸¸è¿è¡Œç”Ÿæˆå‘½ä»¤ä»¥æ£€æŸ¥é”™è¯¯ï¼Œè€Œä¸æ˜¯ä»ä¸€ä»½ç©ºç™½çš„ Markdown æ–‡æ¡£å¼€å§‹ã€‚

## Markdown

Markdown çš„åŸºç¡€è¯­æ³•ï¼Œæˆ‘ç›¸ä¿¡å‡­å€Ÿè‡ªå·±å®åŠ›æ‰¾åˆ°è¿™ä¸ªé¡¹ç›®çš„äººæ— éœ€å¤šè¨€ã€‚

ä½†å¦‚æœæ‚¨è¿˜ä¸ä¼š Markdownï¼Œæˆ‘å»ºè®®æ‚¨èŠ±è´¹ä¸€äº›æ—¶é—´å­¦ä¹ å®ƒâ€”â€”æ¯”èµ·æ’ç‰ˆæµªè´¹çš„æ—¶é—´ï¼Œæˆ‘è®¤ä¸ºæ‚¨æ›´åº”è¯¥å°†æ—¶é—´èŠ±è´¹åœ¨å­¦ä¹  Markdown ä¸Šã€‚æ‚¨å¯ä»¥å‚è€ƒ[è¿™ä¸ªæ•™ç¨‹](https://markdown.com.cn/intro.html)ï¼Œæˆ–æ˜¯[è¿™ä¸ªçŸ¥ä¹é—®é¢˜](https://www.zhihu.com/question/20409634)ã€‚å½“ç„¶ï¼Œå­¦å¥½ Word æ’ç‰ˆä¹Ÿæ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œä½†å¦‚æœæ‚¨è¿æ’ç‰ˆæ¯•ä¸šè®ºæ–‡éƒ½ä¸ä¼šï¼Œæˆ‘è¿˜æ˜¯å»ºè®®æ‚¨å¥½å¥½å­¦ä¹ ä¸€ä¸‹ Office æ“ä½œã€‚

ä½†å•çº¯çš„ Markdown å¹¶ä¸è¶³ä»¥æ”¯æŒæˆ‘ä»¬å®Œæˆæ¯•ä¸šè®ºæ–‡çš„ç”Ÿæˆã€‚å› æ­¤ï¼Œè¯·ç»§ç»­å‘ä¸‹çœ‹ã€‚

## Pandoc Markdown

ç”±äº Markdown åˆ° docx è½¬æ¢é‡‡ç”¨çš„æ˜¯ Pandoc[@Pandoc]ï¼Œè¿™é‡Œå°±ä¸å¾—ä¸æ Pandoc Markdown è¯­æ³•äº†ã€‚æ‚¨å¯ä»¥åœ¨æ’°å†™æ—¶ä½¿ç”¨ Pandoc Markdown è¯­æ³•å®ç°ä¸€äº› Pandoc ç‰¹æ€§ï¼Œä¸è¿‡è¿™å¯èƒ½éœ€è¦æ‚¨å¯¹ Pandoc æœ‰ç€ç†Ÿç»ƒæŒæ¡ï¼Œå¹¶æŒ‰éœ€ä¿®æ”¹ `filter.py`ã€‚å…·ä½“ç»†èŠ‚ï¼Œè¯·æŸ¥é˜…[å®˜æ–¹æ–‡æ¡£](https://pandoc.org/MANUAL.html#pandocs-markdown)ï¼Œæˆ–æ˜¯[è¿™ä»½ï¼ˆå¯èƒ½æœ‰äº›è¿‡æ—¶çš„ï¼‰ä¸­æ–‡ç¿»è¯‘](http://pages.tzengyuxio.me/pandoc/)ã€‚

ğŸ’¡æç¤ºï¼šå¦‚æ‚¨éœ€ä¿ç•™ä¸€ä¸ªç©ºæ®µè½â€”â€”æˆ–è€…æ›´é€šå¸¸æƒ…å†µä¸‹çš„ï¼Œæ¢è¡Œï¼›ä¾‹å¦‚ï¼Œæ‚¨çš„æŒ‡å¯¼è€å¸ˆè¦æ±‚æ‚¨åœ¨â€œç»“è®ºâ€åç©ºä¸€è¡Œï¼›é‚£æ‚¨åº”è¯¥åœ¨ç»“è®ºåç©ºå‡ºä¸€æ®µï¼Œå¹¶è¾“å…¥å››ä¸ªç©ºæ ¼ã€‚

## è‡ªå®šä¹‰ç±» $\LaTeX$ å‘½ä»¤

æ‚¨å¯ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸€äº›ç±» $\LaTeX$ å‘½ä»¤è¾…åŠ© docx çš„æ’ç‰ˆã€‚ç›¸ä¿¡æ‚¨åº”è¯¥å·²ç»åœ¨æœ¬æ–‡ä»¶çš„å¼€å¤´éƒ¨åˆ†è§è¿‡å®ƒä»¬äº†ï¼š

```LaTex
\cover - å°é¢
\statementOfOriginality - åŸåˆ›æ€§å£°æ˜
\abstract - ç”Ÿæˆä¸­æ–‡æ‘˜è¦
\abstractEn - ç”Ÿæˆè‹±æ–‡æ‘˜è¦
\toc - ç›®å½•
\newSectionInNewPage - åˆ†èŠ‚ç¬¦ï¼ˆä¸‹ä¸€é¡µï¼‰
\newSection - åˆ†èŠ‚ç¬¦
\pageBreak - åˆ†é¡µç¬¦
```

éƒ¨åˆ† Markdown ç¼–è¾‘å™¨æ”¯æŒ `[TOC]` ç›®å½•ã€‚æ‚¨ä¹Ÿå¯ä»¥åœ¨é€‚å½“ä½ç½®æ’å…¥ `[TOC]`ï¼Œæˆ‘ä»¬çš„è¿‡æ»¤å™¨ä¼šå°† `[TOC]` è§†ä¸º `\toc`ã€‚è¿™äº›å‘½ä»¤çš„è½¬æ¢è¿‡ç¨‹å‘ç”Ÿåœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `filter.py` ä¸­ï¼Œæ‚¨å¯ä»¥è‡ªè¡Œå‰å¾€ï¼ŒæŸ¥çœ‹å…·ä½“çš„è½¬æ¢ä¸å®ç°ã€‚

å°é¢ã€åŸåˆ›æ€§å£°æ˜å‡å–è‡ªå­¦æ ¡æä¾›çš„æ¨¡æ¿æ–‡ä»¶ã€‚æœ‰å…³å°é¢å†…å®¹ã€é¡µçœ‰å†…å®¹çš„è‡ªåŠ¨å¡«å†™ï¼Œè¯·å‚é˜…ä¸‹ä¸€èŠ‚[å…ƒæ•°æ®](#å…ƒæ•°æ®)ã€‚

æ‚¨**å¿…é¡»**åœ¨æ–‡æ¡£å¼€å¤´æ’å…¥ä¸€ä¸ª `\newSectionInNewPage`ã€‚Pandoc åœ¨ç”Ÿæˆæ—¶ï¼Œä¼šè‡ªåŠ¨åœ¨æ–‡æ¡£å¼€å¤´ç”Ÿæˆå…ƒæ•°æ®ä¸­çš„æ ‡é¢˜ã€ä½œè€…ç­‰ä¿¡æ¯ï¼Œè¿™å¯¹æˆ‘ä»¬æ¥è¯´æ˜¯å¤šä½™çš„ã€‚å› æ­¤ï¼Œåœ¨åå¤„ç†æµç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šåˆ é™¤ç¬¬ä¸€ä¸ª `\newSectionInNewPage` åŠå…¶ä¹‹å‰çš„æ‰€æœ‰å†…å®¹ã€‚

æ¯”å¦‚ï¼Œä¾ç…§æ’°å†™è§„èŒƒ[@ShaMenDa]ï¼Œå¼•è¨€åŠæ­£æ–‡ä¹‹é—´æ˜¯éœ€è¦å¦èµ·ä¸€é¡µçš„ã€‚æ‰€ä»¥ï¼Œæ‚¨åº”è¯¥åœ¨å¼•è¨€ä¸ç¬¬ä¸€ç« ä¹‹é—´ï¼Œæ’å…¥ä¸€ä¸ª `\pageBreak`ã€‚å¦‚è‹¥æ‚¨çš„å­¦é™¢è¦æ±‚â€œæ¯ä¸ªç« èŠ‚ä»¥æ–°ä¸€é¡µä½œä¸ºå¼€å§‹â€ï¼Œåˆ™ä¹Ÿéœ€åœ¨æ¯ä¸ªç« èŠ‚æ ‡é¢˜å‰æ’å…¥ä¸€ä¸ª `\pageBreak`ã€‚

## å°åº•

é»˜è®¤ä¼šåœ¨æ–‡æ¡£æœ«å°¾ç”Ÿæˆç©ºç™½é¡µä½œä¸ºå°åº•ã€‚å¦‚æ‚¨ä¸éœ€è¦ï¼Œè¯·å‚é˜…[ä¸åœ¨æ–‡æ¡£æœ«å°¾ç”Ÿæˆç©ºç™½é¡µä½œä¸ºå°åº•](#ä¸åœ¨æ–‡æ¡£æœ«å°¾ç”Ÿæˆç©ºç™½é¡µä½œä¸ºå°åº•)ä¸€èŠ‚ï¼Œåœ¨ç”Ÿæˆå‘½ä»¤ååŠ ä¸Šå‚æ•° `--no-blank-back-cover`ã€‚

## å…ƒæ•°æ®

Pandoc æä¾›äº† YAML å…ƒæ•°æ®æ‰©å±•ã€‚æ‚¨å¯ä»¥å‘ç°ä¸€ä¸ª `demo/metadata.yaml` æ–‡ä»¶ã€‚åœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹æ ‡é¢˜ã€ä½œè€…ç­‰ä¿¡æ¯ï¼Œæ’°å†™æ‚¨çš„æ‘˜è¦ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œä¸€äº›è¯¸å¦‚å›¾ç‰‡è‡ªåŠ¨ç¼–å·ã€è¡¨æ ¼è‡ªåŠ¨ç¼–å·ã€å…¬å¼è‡ªåŠ¨ç¼–å·çš„é…ç½®ã€‚

æ‚¨å¯ä»¥ç”¨ä»£ç æˆ–æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ YAML æ–‡ä»¶è¿›è¡Œç¼–è¾‘ã€‚å¦‚æœæ‚¨å¹¶ä¸ç†Ÿæ‚‰ YAML è¯­æ³•ï¼Œè¯·åœ¨å®Œæˆç¼–è¾‘åå°†å…¨éƒ¨å†…å®¹å¤åˆ¶åˆ° [YAML æ ¡éªŒå·¥å…·](https://www.bejson.com/validators/yaml_editor/)è¿›è¡Œæ ¡éªŒï¼Œé€šè¿‡åå†è¿›è¡Œä¿å­˜ã€‚

## ç« èŠ‚æ ‡é¢˜åŠè‡ªåŠ¨ç¼–å·

ä¸ºäº†æ­£ç¡®ç”Ÿæˆå¯¹åº”çš„æ ·å¼ï¼Œæ‚¨çš„å¼•è¨€ã€ç»“è®ºã€è‡´è°¢ã€å‚è€ƒæ–‡çŒ®ã€é™„å½•ï¼Œ**èƒ½ä¸”åªèƒ½**å–å€¼ä¸ºï¼šå¼•è¨€ã€æ€»ç»“ã€ç»“è®ºã€è‡´è°¢ã€è‡´è°¢è¯­ã€å‚è€ƒæ–‡çŒ®ã€é™„å½•ã€‚å…·ä½“ç»†èŠ‚ï¼Œè¯·å‚é˜…[æ¨¡æ¿æ–‡ä»¶æ ·å¼è¯´æ˜](#æ¨¡æ¿æ–‡ä»¶æ ·å¼è¯´æ˜)ä¸€èŠ‚ã€‚å¦‚æœæ‚¨å˜æ¢äº†è¿™äº›æ ‡é¢˜ï¼Œå®ƒä»¬å°†æ— æ³•å¾—åˆ°æ­£ç¡®å¤„ç†ã€‚

æˆ‘ä»¬é»˜è®¤é…ç½®äº†ç« èŠ‚æ ‡é¢˜è‡ªåŠ¨ç¼–å·â€”â€”åŒ…æ‹¬æ¯ç« å¼€å¤´è‡ªåŠ¨è½¬å˜ä¸ºâ€œç¬¬ x ç« â€ï¼Œæ‚¨ä»…éœ€åœ¨ Markdown ä¸­è¡Œäº‘æµæ°´åœ°åˆ›ä½œå³å¯ã€‚å¦‚æœæ‚¨é€‰æ‹©äº†ç« èŠ‚æ ‡é¢˜è‡ªåŠ¨ç¼–å·ï¼Œæ­£å¦‚æœ¬æ–‡ä»¶ä¸€æ ·ï¼Œæ‚¨è¿˜éœ€è¦åœ¨å¼•è¨€ã€ç»“è®ºã€è‡´è°¢ã€å‚è€ƒæ–‡çŒ®ã€é™„å½•çš„åé¢åŠ ä¸Š`{.unnumbered}`ï¼Œè¿™ä¼šè®© Pandoc æ„è¯†åˆ°è¿™å‡ èŠ‚æ˜¯æ— éœ€è‡ªåŠ¨ç¼–å·çš„ã€‚

å½“ç„¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥é€‰æ‹©æ‰‹åŠ¨ç¼–å·â€”â€”è¿™å°†ç»™æ‚¨æ ‡é¢˜ç¼–å·çš„æ›´å¤šè‡ªç”±åº¦ï¼Œæ¯”å¦‚ç»“æ„ä¸ºï¼š

- ç¬¬ä¸€ç« 
  - ï¼ˆä¸€ï¼‰
    - `1.`
      - ï¼ˆ1ï¼‰
        - â‘ 

ç­‰ï¼Œè¿™éœ€è¦æ‚¨åœ¨æ’°å†™æ ‡é¢˜æ—¶å°±æ‰‹åŠ¨åŠ å…¥ï¼Œå¦‚ `# ç¬¬ä¸€ç«  ç»ªè®º`è€Œä¸åƒè‡ªåŠ¨ç¼–å·è¿™æ ·çš„ `# ç»ªè®º`ã€‚è¯·åœ¨æ ¹ç›®å½•çš„ `processer.py` ä¸­æ‰¾åˆ° `pandoc_process` å‡½æ•°ï¼Œåœ¨å…¶ä¸­æ³¨é‡Šä»¥ä¸‹å†…å®¹ï¼š

````diff
--- processer.py
                      + '--csl "%s" ' % os.path.join(WHERE_SCRIPT, 'assets/chinese-gb7714-2005-numeric.csl')
-                      + '--number-sections '  # ç« èŠ‚è‡ªåŠ¨ç¼–å·
+                 #    + '--number-sections '  # ç« èŠ‚è‡ªåŠ¨ç¼–å·
                      + source)
````

## å›¾ç‰‡ã€è¡¨æ ¼ã€å…¬å¼çš„å¼•ç”¨åŠè‡ªåŠ¨æ ‡å·

è¯¥åŠŸèƒ½é‡‡ç”¨ [pandoc-xnos](https://github.com/tomduck/pandoc-xnos) è¿‡æ»¤å™¨å¥—ä»¶å®ç°[@Duck2022pandoc-xnos]ã€‚æ‚¨å¯ä»¥åœ¨ `metadata.yaml` ä¸­ä¿®æ”¹å®ƒçš„é…ç½®ï¼š

```yaml
***-plus-name: å›¾ # è¡Œå†…å¼•ç”¨
***-star-name: å›¾ # è¡Œé¦–å¼•ç”¨ï¼ˆæ±‰å­—ç†è®ºä¸Šæ˜¯å’Œè¡Œå†…æ²¡åŒºåˆ«çš„ï¼Œä¸»è¦é¢å‘è¥¿æ–‡ç”¨æˆ·ï¼Œå¤§å°å†™éœ€æ±‚ï¼‰
***-caption-name: å›¾ # æè¿°æ–‡å­—åç§°ï¼Œå¦‚ å›¾ã€Figã€Figure ç­‰
***-caption-separator: period # æè¿°æ–‡å­—ç¼–å·ä¸æè¿°æ–‡æœ¬åˆ†éš”ç¬¦
***-number-by-section: false # æ˜¯å¦æŒ‰ç« èŠ‚ç¼–å·
```

### å›¾ç‰‡åŠè‡ªåŠ¨æ ‡å·

è¯¥åŠŸèƒ½é‡‡ç”¨ pandoc-fignos[Duck2022pandoc-fignos] å®ç°ã€‚

åœ¨ Word ä¸­çš„æ˜¾ç¤ºæ•ˆæœåˆ™ç±»ä¼¼ï¼š

å›¾ç‰‡è¯´æ˜æ–‡å­—ï¼š`å›¾ 1  è¿™æ˜¯å›¾ç‰‡æè¿°`

å›¾ç‰‡å¼•ç”¨ï¼š`å›¾ 1`

æ‚¨å¯ä»¥åƒè¿™æ ·æ’å…¥ä¸€å¼ å›¾ç‰‡ï¼š

```markdown
![Photo by Baim Hanif on Unsplash, Free to use under the Unsplash License](readme.assets/baim-hanif-pYWuOMhtc6k-unsplash.jpg){#fig:graduation}
```

å…¶ä¸­ï¼Œä¸­æ‹¬å·å†…å†™å›¾ç‰‡çš„è¯´æ˜æ–‡å­—ï¼Œæ‹¬å·å†…æ˜¯æ–‡ä»¶çš„è·¯å¾„ï¼ˆå»ºè®®ç”¨ç¼–è¾‘å™¨ç”Ÿæˆç›¸å¯¹ markdown æ–‡ä»¶çš„**ç›¸å¯¹è·¯å¾„**ï¼Œå› ä¸ºæˆ‘ä»¬ä¼šé»˜è®¤ markdown æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸ºèµ„æºæ‰€åœ¨ç›®å½•ï¼‰ï¼Œæœ€åçš„å¤§æ‹¬å·ä¸­ `#fig:` æ¥è‡ª pandoc-fignosï¼Œå†’å·åéœ€è¦æ˜¯ä¸€ä¸ªå…¨æ–‡å”¯ä¸€çš„å­—ç¬¦ä¸²æˆ–æ˜¯æ•°å­—ã€‚æ‚¨å¯ä»¥é€šè¿‡ `+@fig:graduation{nolink=True}` è¿™æ ·çš„è¯­æ³•å»å¼•ç”¨å›¾ç‰‡å¹¶å®ç°è‡ªåŠ¨æ ‡å·ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè¡Œå†…å¼•ç”¨ä»¥ `+` å¼€å¤´ï¼Œè¡Œé¦–å¼•ç”¨ä»¥ `*` å¼€å¤´ã€‚`nolink=True` è¡¨ç¤ºä¸ä¸ºå¼•ç”¨ç”Ÿæˆè¶…é“¾æ¥ã€‚å½“æ‚¨å¼•ç”¨å›¾ç‰‡æ—¶ï¼Œå¦‚æœé€‰æ‹©æ·»åŠ è¶…é“¾æ¥ï¼Œæ‚¨å¯èƒ½éœ€è¦åœ¨å¼•ç”¨å‘½ä»¤å¤–åŒ…è£¹ä»¥å¤§æ‹¬å·ï¼š`{+@fig:graduation}`ã€‚å…·ä½“ç»†èŠ‚ï¼Œè¯·å‚é˜… [pandoc-fignos æ–‡æ¡£](https://github.com/tomduck/pandoc-tablenos)ã€‚

ä¸Šè¿°è¯­æ³•æ’å…¥çš„å›¾ç‰‡æ¥è‡ª [Unsplash](https://unsplash.com/s/photos/graduation?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ç½‘ç«™çš„ [Baim Hanif](https://unsplash.com/@baim?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)ï¼Œé‡‡ç”¨ [Unsplash License](https://unsplash.com/license) æˆæƒå…è´¹ä½¿ç”¨ï¼Œå¦‚ä¸‹+@fig:graduation{nolink=True}æ‰€ç¤ºï¼š

![Photo by Baim Hanif on Unsplash,  Free to use under the Unsplash License](readme.assets/baim-hanif-pYWuOMhtc6k-unsplash.jpg){#fig:graduation}

å¦ä¸€å¼ æ¥è‡ª [Unsplash](https://unsplash.com/s/photos/graduation?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ç½‘ç«™ [Joan Kwamboka](https://unsplash.com/@city_child?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) çš„å›¾ç‰‡ï¼Œé‡‡ç”¨ [Unsplash License](https://unsplash.com/license) æˆæƒå…è´¹ä½¿ç”¨ï¼Œå¦‚ä¸‹{+@fig:graduation2}æ‰€ç¤ºï¼š

![Photo by Joan Kwamboka on Unsplash, Free to use under the [Unsplash License](https://unsplash.com/license)](readme.assets/joan-kwamboka-hvL7qlvZ5T4-unsplash.jpg){#fig:graduation2}

### è¡¨æ ¼åŠè‡ªåŠ¨ç¼–å·

è¯¥åŠŸèƒ½é‡‡ç”¨ pandoc-tablenos[@Duck2022pandoc-tablenos] å®ç°ã€‚

åœ¨ Word ä¸­çš„æ˜¾ç¤ºæ•ˆæœåˆ™ç±»ä¼¼ï¼š

è¡¨æ ¼è¯´æ˜æ–‡å­—ï¼š`è¡¨ 1  è¿™æ˜¯è¡¨æ ¼æè¿°`

è¡¨æ ¼å¼•ç”¨ï¼š`è¡¨ 1`

è¡¨æ ¼çš„æ’å…¥å»ºè®®é‡‡ç”¨ç¼–è¾‘å™¨ã€‚ç›®å‰ï¼ŒMarkdown ä¸­çš„è¡¨æ ¼å¹¶ä¸æ”¯æŒåˆå¹¶å•å…ƒæ ¼ï¼›HTML è¡¨æ ¼ä¹Ÿæš‚æ—¶ä¸è¢«æ”¯æŒã€‚æˆ‘ä»¬å»ºè®®æ‚¨ç•™ç©ºæ‰€éœ€çš„å•å…ƒæ ¼ï¼Œåœ¨ç”Ÿæˆ Word æ–‡æ¡£åæ‰‹åŠ¨åˆå¹¶ã€‚æˆ‘ä»¬çš„è¡¨æ ¼æ ·å¼é‡‡ç”¨ä¸‰çº¿è¡¨ï¼Œæœ‰å…³è¡¨æ ¼æ ·å¼çš„è¯¦ç»†æƒ…å†µï¼Œè¯·å‚é˜…åæ–‡ [Table](#Table) ä¸€èŠ‚ã€‚

æ‚¨å¯ä»¥åœ¨è¡¨æ ¼å‰åè¿™æ ·è¿™æ ·æ’å…¥è¡¨æ ¼çš„è¯´æ˜æ–‡å­—ï¼š

```markdown
: çŸ¥è¯†å…±äº«è®¸å¯åè®®çš„å››é¡¹åŸºæœ¬æƒåˆ© {#tbl:CC_four_rights}
```

æœ€åçš„å¤§æ‹¬å·ä¸­ `#tbl:` æ¥è‡ª pandoc-tablenosï¼Œå†’å·åéœ€è¦æ˜¯ä¸€ä¸ªå…¨æ–‡å”¯ä¸€çš„å­—ç¬¦ä¸²æˆ–æ˜¯æ•°å­—ã€‚æ‚¨å¯ä»¥é€šè¿‡ `+@tbl:CC_four_rights{nolink=True}` è¿™æ ·çš„è¯­æ³•å»å¼•ç”¨å›¾ç‰‡å¹¶å®ç°è‡ªåŠ¨æ ‡å·ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè¡Œå†…å¼•ç”¨ä»¥ `+` å¼€å¤´ï¼Œè¡Œé¦–å¼•ç”¨ä»¥ `*` å¼€å¤´ã€‚`nolink=True` è¡¨ç¤ºä¸ä¸ºå¼•ç”¨ç”Ÿæˆè¶…é“¾æ¥ã€‚å½“æ‚¨å¼•ç”¨å›¾ç‰‡æ—¶ï¼Œå¦‚æœé€‰æ‹©æ·»åŠ è¶…é“¾æ¥ï¼Œæ‚¨å¯èƒ½éœ€è¦åœ¨å¼•ç”¨å‘½ä»¤å¤–åŒ…è£¹ä»¥å¤§æ‹¬å·ï¼š`{+@tbl:CC_four_rights}`ã€‚å…·ä½“ç»†èŠ‚ï¼Œè¯·å‚é˜… [pandoc-tablenos æ–‡æ¡£](https://github.com/tomduck/pandoc-tablenos)ã€‚

ä¸‹+@tbl:CC_four_rights{nolink=True}å¼•ç”¨è‡ª[çŸ¥è¯†å…±äº«è®¸å¯åè®® - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦](https://zh.wikipedia.org/wiki/%E7%9F%A5%E8%AF%86%E5%85%B1%E4%BA%AB%E8%AE%B8%E5%8F%AF%E5%8D%8F%E8%AE%AE)ï¼š

: çŸ¥è¯†å…±äº«è®¸å¯åè®®çš„å››é¡¹åŸºæœ¬æƒåˆ© {#tbl:CC_four_rights}

| æƒåˆ©                                                         | å¤‡æ³¨                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| **ç½²å**ï¼ˆè‹±è¯­ï¼šAttributionï¼Œ**by**ï¼‰                        | æ‚¨ï¼ˆç”¨æˆ·ï¼‰å¯ä»¥å¤åˆ¶ã€å‘è¡Œã€å±•è§ˆã€è¡¨æ¼”ã€æ”¾æ˜ ã€å¹¿æ’­æˆ–é€šè¿‡ä¿¡æ¯ç½‘ç»œä¼ æ’­æœ¬ä½œå“ï¼›æ‚¨å¿…é¡»æŒ‰ç…§ä½œè€…æˆ–è€…è®¸å¯äººæŒ‡å®šçš„æ–¹å¼å¯¹ä½œå“è¿›è¡Œç½²åã€‚ |
| **[ç›¸åŒæ–¹å¼å…±äº«](https://zh.wikipedia.org/wiki/ç›¸åŒæ–¹å¼å…±äº«)**ï¼ˆè‹±è¯­ï¼š**S**hare**A**likeï¼Œ**sa**ï¼‰ | æ‚¨å¯ä»¥è‡ªç”±å¤åˆ¶ã€æ•£å¸ƒã€å±•ç¤ºåŠæ¼”å‡ºæœ¬ä½œå“ï¼›è‹¥æ‚¨æ”¹å˜ã€è½¬å˜æˆ–æ›´æ”¹æœ¬ä½œå“ï¼Œä»…åœ¨éµå®ˆä¸æœ¬ä½œå“ç›¸åŒçš„æˆæƒæ¡æ¬¾ä¸‹ï¼Œæ‚¨æ‰èƒ½æ•£å¸ƒç”±æœ¬ä½œå“äº§ç”Ÿçš„æ´¾ç”Ÿä½œå“ã€‚ï¼ˆå‚è§ [copyleft](https://zh.wikipedia.org/wiki/Copyleft)ï¼‰ã€‚ |
| **éå•†ä¸šæ€§ä½¿ç”¨**ï¼ˆè‹±è¯­ï¼š**N**on**c**ommercial,**nc** ï¼‰      | æ‚¨å¯ä»¥è‡ªç”±å¤åˆ¶ã€æ•£å¸ƒã€å±•ç¤ºåŠæ¼”å‡ºæœ¬ä½œå“ï¼›æ‚¨ä¸å¾—ä¸º[å•†ä¸š](https://zh.wikipedia.org/wiki/å•†ä¸š)ç›®çš„è€Œä½¿ç”¨æœ¬ä½œå“ã€‚ |
| **ç¦æ­¢æ¼”ç»**ï¼ˆè‹±è¯­ï¼š**N**o **D**erivative Worksï¼Œ**nd**)     | æ‚¨å¯ä»¥è‡ªç”±å¤åˆ¶ã€æ•£å¸ƒã€å±•ç¤ºåŠæ¼”å‡ºæœ¬ä½œå“ï¼›æ‚¨ä¸å¾—æ”¹å˜ã€è½¬å˜æˆ–æ›´æ”¹æœ¬ä½œå“ã€‚ |

ä¸‹{+@tbl:open_source_licenses_comparison}å¼•ç”¨è‡ª[è‡ªç”±åŠå¼€æ”¾åŸå§‹ç è½¯ä½“è®¸å¯è¯æ¯”è¾ƒ - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦](https://zh.wikipedia.org/wiki/%E8%87%AA%E7%94%B1%E5%8F%8A%E9%96%8B%E6%94%BE%E5%8E%9F%E5%A7%8B%E7%A2%BC%E8%BB%9F%E9%AB%94%E8%A8%B1%E5%8F%AF%E8%AD%89%E6%AF%94%E8%BC%83)ï¼š

: è‡ªç”±åŠå¼€æ”¾åŸå§‹ç è½¯ä½“è®¸å¯è¯æ¯”è¾ƒ {#tbl:open_source_licenses_comparison}

| è®¸å¯è¯                                                       | ç‰ˆæœ¬ | åŒ…å«è®¸å¯è¯ | åŒ…å«åŸå§‹ç  | è¿ç»“ | çŠ¶æ€å˜åŒ– | å•†ä¸šä½¿ç”¨ | æ•£å¸ƒ | ä¿®æ”¹ | ä¸“åˆ©æˆæƒ | ç§äººä½¿ç”¨ | æˆæƒè½¬å”® | æ— æ‹…ä¿è´£ä»» | æ²¡æœ‰å•†æ ‡ |
| ------------------------------------------------------------ | ---- | ---------- | ---------- | ---- | -------- | -------- | ---- | ---- | -------- | -------- | -------- | ---------- | -------- |
| [Apache è®¸å¯è¯](https://zh.wikipedia.org/wiki/Apacheè®¸å¯è¯)  | 2.0  | æ˜¯         |            |      | æ˜¯       | æ˜¯       | æ˜¯   | æ˜¯   | æ˜¯       | æ˜¯       | æ˜¯       | æ˜¯         | æ˜¯       |
| [3 å¥ç‰ˆ BSD è®¸å¯è¯](https://zh.wikipedia.org/wiki/BSDè®¸å¯è¯) |      | æ˜¯         |            |      |          | æ˜¯       | æ˜¯   | æ˜¯   |          | æ˜¯       | æ˜¯       | æ˜¯         | æ˜¯       |
| [2 å¥ç‰ˆ BSD è®¸å¯è¯](https://zh.wikipedia.org/wiki/BSDè®¸å¯è¯) |      | æ˜¯         |            |      |          | æ˜¯       | æ˜¯   | æ˜¯   |          | æ˜¯       | æ˜¯       | æ˜¯         |          |
| [GNU é€šç”¨å…¬å…±è®¸å¯è¯](https://zh.wikipedia.org/wiki/GNUé€šç”¨å…¬å…±è®¸å¯è¯) | 2.0  | æ˜¯         | æ˜¯         |      | æ˜¯       | æ˜¯       | æ˜¯   | æ˜¯   | æ˜¯       | æ˜¯       | å¦       | æ˜¯         |          |
| [GNU é€šç”¨å…¬å…±è®¸å¯è¯](https://zh.wikipedia.org/wiki/GNUé€šç”¨å…¬å…±è®¸å¯è¯) | 3.0  | æ˜¯         | æ˜¯         |      | æ˜¯       | æ˜¯       | æ˜¯   | æ˜¯   | æ˜¯       | æ˜¯       | æ˜¯       | æ˜¯         |          |
| [GNU å®½é€šç”¨å…¬å…±è®¸å¯è¯](https://zh.wikipedia.org/wiki/GNUå®½é€šç”¨å…¬å…±è®¸å¯è¯) | 2.1  | æ˜¯         | æ˜¯         | æ˜¯   |          | æ˜¯       | æ˜¯   | æ˜¯   | æ˜¯       | æ˜¯       | æ˜¯       | æ˜¯         |          |
| [GNU å®½é€šç”¨å…¬å…±è®¸å¯è¯](https://zh.wikipedia.org/wiki/GNUå®½é€šç”¨å…¬å…±è®¸å¯è¯) | 3.0  | æ˜¯         | æ˜¯         | æ˜¯   |          | æ˜¯       | æ˜¯   | æ˜¯   | æ˜¯       | æ˜¯       | æ˜¯       | æ˜¯         |          |

### å…¬å¼åŠè‡ªåŠ¨ç¼–å·

è¯¥åŠŸèƒ½é‡‡ç”¨ pandoc-eqnos[@Duck2022pandoc-eqnos] å®ç°ã€‚

åœ¨ Word ä¸­çš„æ˜¾ç¤ºæ•ˆæœåˆ™ç±»ä¼¼ï¼š

å…¬å¼æ˜¾ç¤ºï¼š`pi = 3.14159265  (1)`

å…¬å¼å¼•ç”¨ï¼šå¼€å¯ç¾å›½æ•°å­¦åä¼šé£æ ¼ï¼š`å¼ (1)`ã€å…³é—­ç¾å›½æ•°å­¦åä¼šé£æ ¼ï¼š`å¼ 1`

ç¾å›½æ•°å­¦åä¼šé£æ ¼é»˜è®¤å¼€å¯ã€‚æ‚¨å¯ä»¥åœ¨ `metadata.yaml` ä¸­ä¿®æ”¹å®ƒçš„é…ç½®ï¼Œå°† `true` æ”¹ä¸º `false`ï¼š

```yaml
eqnos-eqref: true # å¼€å¯ç¾å›½æ•°å­¦åä¼šï¼ˆAMSï¼‰é£æ ¼å¼•ç”¨
```

æ‚¨å¯ä»¥ä»¥ä¸‹åˆ—å‘½ä»¤è¾“å…¥ $\TeX$ æ ¼å¼å…¬å¼ï¼š

```markdown
$$ \pi = 3.141592653589793238462643 \ldots $$ {#eq:pi}

$$ S = \pi \times r^{2} $$ {#eq:area_of_circle}
```

æœ€åçš„å¤§æ‹¬å·ä¸­ `#eq:` æ¥è‡ª pandoc-eqnosï¼Œå†’å·åéœ€è¦æ˜¯ä¸€ä¸ªå…¨æ–‡å”¯ä¸€çš„å­—ç¬¦ä¸²æˆ–æ˜¯æ•°å­—ã€‚æ‚¨å¯ä»¥é€šè¿‡ `+@eq:area_of_circle{nolink=True}` è¿™æ ·çš„è¯­æ³•å»å¼•ç”¨å›¾ç‰‡å¹¶å®ç°è‡ªåŠ¨æ ‡å·ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè¡Œå†…å¼•ç”¨ä»¥ `+` å¼€å¤´ï¼Œè¡Œé¦–å¼•ç”¨ä»¥ `*` å¼€å¤´ã€‚`nolink=True` è¡¨ç¤ºä¸ä¸ºå¼•ç”¨ç”Ÿæˆè¶…é“¾æ¥ã€‚å½“æ‚¨å¼•ç”¨å›¾ç‰‡æ—¶ï¼Œå¦‚æœé€‰æ‹©æ·»åŠ è¶…é“¾æ¥ï¼Œæ‚¨å¯èƒ½éœ€è¦åœ¨å¼•ç”¨å‘½ä»¤å¤–åŒ…è£¹ä»¥å¤§æ‹¬å·ï¼š`{+@eq:area_of_circle}`ã€‚å…·ä½“ç»†èŠ‚ï¼Œè¯·å‚é˜… [pandoc-eqnos æ–‡æ¡£](https://github.com/tomduck/pandoc-eqnos)ã€‚

$$ \pi = 3.141592653589793238462643 \ldots $$ {#eq:pi}

$$ S = \pi \times r^{2} $$ {#eq:area_of_circle}

*@eq:pi{nolink=True} å±•ç°äº† Piï¼Œå®ƒæ˜¯ä¸€ä¸ªæ— ç†æ•°ã€‚è®¡ç®—åœ†çš„é¢ç§¯ï¼Œä¸€èˆ¬ä¼šç”¨{+@eq:area_of_circle}ã€‚

è¡Œå†…å…¬å¼ï¼Œå¯ä»¥ä½¿ç”¨è¯­æ³• `$\pi = 3.141592653589793238462643 \ldots$` ã€‚ç»“æœæ˜¯è¿™æ ·çš„ï¼š$\pi = 3.141592653589793238462643 \ldots$ã€‚

âš è¯·æ³¨æ„ï¼šç”±äºæœ¬æ–‡æ¡£ä¸­å‡ºç°äº†éƒ¨åˆ†çš„ $\LaTeX$ è¯­æ³•ï¼Œåœ¨è½¬æ¢æ—¶å¯èƒ½å‡ºç° Warningï¼Œè¯¸å¦‚ `[WARNING] Could not convert TeX math \LaTeX, rendering as TeX:` ã€‚åœ¨æ’°å†™æ—¶ï¼Œè¯·å°½é‡ä¿è¯å…¬å¼é‡‡ç”¨ $\TeX$ è¯­æ³•ã€‚

âš å¦è¯·æ³¨æ„ï¼šæ ¹æ®ç¬”è€…åœ¨ 2022 å¹´ 3 æœˆ 31 æ—¥çš„æµ‹è¯•ï¼Œpandoc_eqnos å­˜åœ¨ bugï¼Œä¼šå¯¼è‡´ç”Ÿæˆçš„ docx æ–‡ä»¶æ— æ³•æ‰“å¼€ã€‚å¼€å‘è€… nOkuda æå‡ºäº†é—®é¢˜å¹¶æäº¤äº† [Pull Requests](https://github.com/tomduck/pandoc-eqnos/pull/64)ã€‚ç›®å‰ï¼Œæˆ‘ä»¬ä¼šä¸‹è½½ [pandoc_eqnos.py](https://raw.githubusercontent.com/nOkuda/pandoc-eqnos/docxOpen/pandoc_eqnos.py) æ–‡ä»¶ï¼Œå¹¶å°† pandoc_eqnos.py æ”¾ç½®åœ¨æœ¬æ–‡ä»¶çš„åŒä¸€å±‚çº§ç›®å½•ä¸‹ï¼Œå¹¶ä½¿ç”¨è¯¥æ–‡ä»¶ä½œä¸º pandoc_qunos çš„è¿‡æ»¤å™¨ã€‚è¯·å…³æ³¨ä¸Šè¿° Pull Requests æ˜¯å¦è¢«åˆå¹¶ã€pandoc_eqnos æ˜¯å¦æ›´æ–°é«˜äº 2.5.0 çš„ç‰ˆæœ¬ã€‚è‹¥æ˜¯ã€ä¸”æƒ³ä½¿ç”¨å®˜æ–¹ç‰ˆæœ¬ï¼Œè¯·æŒ‰ä¸‹ä¿®æ”¹ `processer.py`ï¼š

```diff
--- processer.py
                      + '--filter pandoc-fignos '  # å›¾ç‰‡è‡ªåŠ¨ç¼–å·
                      + '--filter pandoc-tablenos '  # è¡¨æ ¼è‡ªåŠ¨ç¼–å·
-                     # '--filter pandoc_eqnos '  # å…¬å¼è‡ªåŠ¨ç¼–å·ï¼Œ
+                     '--filter pandoc_eqnos '  # å…¬å¼è‡ªåŠ¨ç¼–å·ï¼Œ

                      # 2022å¹´ 3 æœˆ 31 æ—¥ï¼Œä¸ªäººæµ‹è¯• pandoc_eqnos å­˜åœ¨ bugï¼Œä¼šå¯¼è‡´ç”Ÿæˆçš„ docx æ–‡ä»¶æ— æ³•æ‰“å¼€
                      # å¼€å‘è€… nOkuda æå‡ºäº†é—®é¢˜å¹¶æäº¤äº† PRï¼Œå‚è§ï¼šhttps://github.com/tomduck/pandoc-eqnos/pull/64
                      # æˆ‘ä»¬ä¼šä¸‹è½½ https://raw.githubusercontent.com/nOkuda/pandoc-eqnos/docxOpen/pandoc_eqnos.py
                      # å¹¶å°† pandoc_eqnos.py æ”¾ç½®åœ¨æœ¬æ–‡ä»¶çš„åŒä¸€å±‚çº§ç›®å½•ä¸‹ï¼Œå¹¶ä½¿ç”¨è¯¥æ–‡ä»¶ä½œä¸º pandoc_qunos çš„è¿‡æ»¤å™¨ã€‚
                      # è¯·å…³æ³¨ https://github.com/tomduck/pandoc-eqnos/pull/64 æ˜¯å¦è¢«åˆå¹¶ã€
                      # pandoc_eqnos æ˜¯å¦æ›´æ–°é«˜äº 2.5.0 çš„ç‰ˆæœ¬ã€‚è‹¥æ˜¯ã€ä¸”æƒ³ä½¿ç”¨å®˜æ–¹ç‰ˆæœ¬ï¼Œ
                      # è¯·ï¼šæ³¨é‡Šä¸‹ä¸€è¡Œï¼Œå¹¶å–æ¶ˆä¸Šæ–¹â€œå…¬å¼è‡ªåŠ¨ç¼–å·â€è¡Œçš„æ³¨é‡Šã€‚
-                     + '--filter "%s" ' % os.path.join(WHERE_SCRIPT, 'pandoc_eqnos.py')
+                     # + '--filter "%s" ' % os.path.join(WHERE_SCRIPT, 'pandoc_eqnos.py')

                      # ä¸Šé¢ä¸‰ä¸ªè‡ªåŠ¨ç¼–å·è¿‡æ»¤å™¨å¿…é¡»å‰ç½®äºæˆ‘ä»¬çš„è‡ªå®šä¹‰è¿‡æ»¤å™¨ä¸ --citeproc
```

## ä»£ç ä¸ä»£ç é«˜äº®

ä»£ç è¯·ä½¿ç”¨ Markdown ä»£ç å—ã€‚ä»£ç é«˜äº®é£æ ¼ï¼Œå‚é˜…[Pandoc æ–‡æ¡£ Syntax highlighting ä¸€èŠ‚](https://pandoc.org/MANUAL.html#syntax-highlighting)ã€‚è€ƒè™‘åˆ°æ‰“å°éœ€æ±‚ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸€ä¸ªç°åº¦é£æ ¼`monochrome`ã€‚é«˜äº®é£æ ¼çš„æ ·ä¾‹ï¼Œå¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/kaityo256/pandoc_highlight)æŸ¥çœ‹ã€‚å¦‚éœ€ä¿®æ”¹ï¼Œè¯·åœ¨æ ¹ç›®å½•çš„ `processer.py` ä¸­æ‰¾åˆ° `pandoc_process` å‡½æ•°ä¸­ä¿®æ”¹ï¼š

```diff
--- processer.py
                      # èµ„æºæ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤ä¸è¾“å…¥æ–‡ä»¶ä¸€è‡´
                      + '--resource-path="%s" ' % os.path.dirname(source)
-                     + '--highlight-style monochrome '  # è€ƒè™‘åˆ°æœ€åéœ€è¦æ‰“å°ï¼Œé€‰äº†ä¸ªç°åº¦çš„é«˜äº®é£æ ¼
+                     + '--highlight-style pygments '  # æ¢æˆäº† pygments é£æ ¼
                      + '--filter pandoc-fignos '  # å›¾ç‰‡è‡ªåŠ¨ç¼–å·
```

## å‚è€ƒæ–‡çŒ®åŠè‡ªåŠ¨ç”Ÿæˆå¼•æ–‡

### å‚è€ƒæ–‡çŒ®æ”¾ç½®

æ ¹æ® [Pandoc æ–‡æ¡£ Placement of the bibliography](https://pandoc.org/MANUAL.html#placement-of-the-bibliography)ï¼Œæ‚¨éœ€è¦åœ¨æ”¾ç½®å‚è€ƒæ–‡çŒ®åˆ—è¡¨çš„åœ°æ–¹æ”¾ç½®ä»¥ä¸‹æ–‡æœ¬ï¼š

```
::: {#refs}
:::
```

å¦‚ä¸æ”¾ç½®ï¼Œå°†ä¼šåœ¨æ–‡æœ«æœ€åç”Ÿæˆå‚è€ƒæ–‡çŒ®åˆ—è¡¨ã€‚

### å¼•æ–‡æ–‡ä»¶ä¸å¼•æ–‡è‡ªåŠ¨ç”Ÿæˆ

å¼•æ–‡ä¾é  Pandoc è‡ªåŠ¨ç”Ÿæˆï¼Œéœ€è¦æä¾›ä¸€ä¸ª BibTeX æ ¼å¼[@BibTeX]å¼•æ–‡æ–‡ä»¶ã€‚æ‚¨å¯ä»¥åœ¨ `/demo/ref.bib` ä¸­æ‰¾åˆ°æœ¬æ–‡ä½¿ç”¨çš„å¼•æ–‡æ–‡ä»¶ã€‚å…·ä½“æ•™ç¨‹ï¼Œè¯·å‚é˜…é™„å½•ä¸­çš„ [Zotero ç®€æ˜æ•™ç¨‹](## Zotero_ç®€æ˜æ•™ç¨‹)ã€‚

æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹è¯­æ³•æ’å…¥å¼•æ–‡ï¼š`[@BibTeX]`ã€‚åœ¨å¸Œæœ›æ’å…¥å¼•æ–‡çš„åœ°æ–¹ï¼Œæ’å…¥æ–¹æ‹¬å·ï¼Œ`@` åè·Ÿ Zotero å†…çš„ Citation Key å³å¯ã€‚æ¯”å¦‚ï¼Œæˆ‘åˆå¼•ç”¨äº†ä¸€é BibTeX å®˜ç½‘[@BibTeX]ã€‚

# æ–‡ä»¶è½¬æ¢ä¸ç›®æ ‡ç”Ÿæˆ

ä»¥ä¸‹å‘½ä»¤**å‡å‡è®¾æ‚¨å¤„äºæœ¬é¡¹ç›®ç›®å½•å†…ä½¿ç”¨**ã€‚

## ä¸€èˆ¬æ€§ä½¿ç”¨

ä¸€èˆ¬æ€§ä½¿ç”¨åŒ…å«é¢„å¤„ç†ã€Pandoc å¤„ç†ã€åå¤„ç†æ•´ä¸ªæµç¨‹ã€‚æ‚¨å¯ä»¥è¿è¡Œï¼š

```bash
python processer.py -O result.docx -F ./demo/readme.md -M ./demo/metadata.yaml -B ./demo/ref.bib
```

å…¶ä¸­ï¼š

- `-O` æˆ– `--output`ï¼šåæ¥æ‚¨æœŸæœ›çš„è¾“å‡º docx æ–‡ä»¶è·¯å¾„ã€‚å¿…é¡»ã€‚
- `-F` æˆ– `--file`ï¼šåæ¥è¾“å…¥çš„ Markdown æ–‡ä»¶è·¯å¾„ã€‚å¿…é¡»ã€‚
- `-M` æˆ– `--metadata-file`ï¼šåæ¥è¾“å…¥çš„å…ƒæ•°æ® yaml æ–‡ä»¶è·¯å¾„ã€‚å¿…é¡»ã€‚
- `-B` æˆ– `--bibliography`ï¼šåæ¥è¾“å…¥çš„å‚è€ƒæ–‡çŒ® BibTeX æ–‡ä»¶è·¯å¾„ã€‚è¯¥å‚æ•°æ˜¯å¯é€‰çš„ï¼Œä¾¿äºæ‚¨åœ¨å°šæœªæ·»åŠ å¼•æ–‡æ—¶æŸ¥çœ‹æ–‡æ¡£çš„æ’ç‰ˆæ•ˆæœã€‚æ¯”å¦‚ï¼Œå½“æ‚¨å°šæœªè¿›è¡Œåˆ°å¼•æ–‡çš„å¼•å…¥æ—¶ï¼Œå¯ä»¥ä»…è¿è¡Œæœ‰ä¸‰ä¸ªå‚æ•°çš„å‘½ä»¤ï¼š`python processer.py -O result.docx -F ./demo/readme.md -M ./demo/metadata.yaml`

## ä»…è¿›è¡Œé¢„å¤„ç†

```bash
python processer.py --pre
```

## ä»…è¿›è¡Œåå¤„ç†

```bash
python processer.py --post -O result.docx -F ./build/pandoc_processed.docx 
```

å…¶ä¸­ï¼š

- `-O` æˆ– `--output`ï¼šåæ¥æ‚¨æœŸæœ›çš„è¾“å‡º docx æ–‡ä»¶è·¯å¾„ã€‚å¯é€‰ï¼Œé»˜è®¤ä¸ºè¯¥é¡¹ç›®ä¸‹çš„ `build/final.docx`ã€‚
- `-F` æˆ– `--file`ï¼šåæ¥è¾“å…¥çš„ã€pandoc å¤„ç†è¿‡çš„ docx æ–‡ä»¶è·¯å¾„ã€‚å¯é€‰ï¼Œé»˜è®¤ä¸ºè¯¥é¡¹ç›®ä¸‹çš„ `build/pandoc_processed.docx`ã€‚

## æ¸…ç†

```
python processer.py --clean
```

è¯¥å‘½ä»¤å°†æ¸…ç†ä¸´æ—¶æ–‡ä»¶ã€‚

## å¸®åŠ©æ–‡æœ¬

```bash
python processer.py --h
```

## ä¸åœ¨æ–‡æ¡£æœ«å°¾ç”Ÿæˆç©ºç™½é¡µä½œä¸ºå°åº•

```bash
python processer.py ...ç•¥... --no-blank-back-cover
```

è‹¥ä¸æ·»åŠ è¯¥å‚æ•°ï¼Œåˆ™é»˜è®¤ä¼šåœ¨æ–‡æ¡£æœ«å°¾ç”Ÿæˆç©ºç™½é¡µä½œä¸ºå°åº•ã€‚

## åˆ›å»ºæ¨¡æ¿

```bash
python processer.py --new path_of_your_destination_directory
```

ä½¿ç”¨è¯¥å‘½ä»¤ï¼Œåœ¨æŒ‡å®šç›®å½•åˆ›å»ºæœ€å°åŒ–çš„æ¨¡æ¿ä»¥ä¾¿å¿«é€Ÿå¼€å§‹ï¼Œ

## æ›´å¤š

å‚é˜… `processer.py`ã€‚

æ—¶é—´ç´§è¿«ï¼Œå‚æ•°æœªç»è¿‡è¯¦ç»†æµ‹è¯•ã€‚ä½¿ç”¨éä¸Šæ–¹æŒ‡æ˜å‚æ•°å†™æ³•ï¼Œå¯èƒ½ä¼šäº§ç”Ÿæ„æ–™ä¹‹å¤–çš„ç»“æœã€‚

# ç”Ÿæˆåçš„æ“ä½œ

æ‚¨åœ¨æ‰“å¼€ç”Ÿæˆçš„ docx æ–‡ä»¶æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹å¯¹è¯æ¡†ã€‚è¯·é€‰æ‹©æ˜¯ï¼Œä»¥ç”Ÿæˆç›®å½•ã€‚

![æ›´æ–°åŸŸæç¤º](readme.assets/image-20220402190735954.png){#fig:generated_docx}

æ‚¨éœ€è¦æ£€æŸ¥ç”Ÿæˆåçš„ docx æ–‡ä»¶ä¸­å›¾ç‰‡çš„æ’ç‰ˆï¼Œè°ƒæ•´å›¾ç‰‡çš„å¤§å°ã€‚

å½“æ‚¨çš„æ ‡é¢˜è¿‡é•¿æ—¶ï¼Œæ‚¨å¯ä»¥æŒ‰ä½ Shift + Enterï¼Œåœ¨éœ€è¦çš„åœ°æ–¹æ’å…¥**è½¯å›è½¦**ã€‚

# ä¿®æ”¹æ¨¡æ¿æ–‡ä»¶

æœ‰æ—¶ï¼Œæ‚¨ä¹Ÿè®¸ä¼šå¯¹é»˜è®¤çš„æ ·å¼ä¸æ»¡æ„ï¼Œå¸Œæœ›è¿›è¡Œä¿®æ”¹ã€‚

åœ¨ä¿®æ”¹æ¨¡æ¿æ–‡ä»¶å‰ï¼Œæ‚¨åº”è‡³å°‘æˆåŠŸè¿è¡Œè¿‡ä¸€æ¬¡[ä¸€èˆ¬æ€§ä½¿ç”¨](#ä¸€èˆ¬æ€§ä½¿ç”¨)æˆ–[ä»…è¿›è¡Œé¢„å¤„ç†](#ä»…è¿›è¡Œé¢„å¤„ç†)çš„å‘½ä»¤ã€‚

å‰å¾€æœ¬é¡¹ç›®å†…çš„ `assets` ç›®å½•ï¼Œæ‚¨å°†æ‰¾åˆ°ä¸€ä»½ `template.docx`ã€‚è¯·æ‰“å¼€è¯¥æ–‡ä»¶å¹¶ä¿®æ”¹å…¶ä¸­çš„æ ·å¼ã€‚

æˆ‘ä»¬åœ¨[æ¨¡æ¿æ–‡ä»¶æ ·å¼è¯´æ˜](#æ¨¡æ¿æ–‡ä»¶æ ·å¼è¯´æ˜)ä¸€èŠ‚ä¸­ï¼Œåˆ—å‡ºäº†æˆ‘ä»¬ç”¨åˆ°çš„ã€ä¸”åšå‡ºä¸»è¦ä¿®æ”¹çš„æ ·å¼ã€‚

æ‚¨å¯ä»¥åœ¨ç”Ÿæˆçš„ docx æ–‡ä»¶ä¸­ï¼Œç¡®è®¤è¦ä¿®æ”¹çš„æ ·å¼ï¼Œå¹¶åœ¨ `template.docx` ä¸­åšå‡ºä¿®æ”¹ã€‚

âš æ³¨æ„ï¼šæ˜¯ä¿®æ”¹â€œæ ·å¼â€ï¼Œè€Œéåœ¨æ–‡æ¡£å†…å®¹ä¸Šè¿›è¡Œç¼–è¾‘ï¼š

![image-20220406192315077](readme.assets/image-20220406192315077.png)

æ‚¨å¯ä»¥è°ƒå‡ºâ€œåº”ç”¨æ ·å¼â€çª—å£ï¼ŒæŸ¥æ‰¾æˆ–è¾“å…¥æ‚¨æ¬²ä¿®æ”¹çš„æ ·å¼ï¼Œç‚¹å‡»â€œä¿®æ”¹â€ä»¥è¿›è¡Œä¿®æ”¹ã€‚

å®Œæˆä¿®æ”¹åï¼Œè¯·**è‡ªè¡Œå¤‡ä»½**å¥½æ‚¨çš„ `template.docx`ã€‚æˆ‘ä»¬çš„[æ¸…ç†](#æ¸…ç†)å‘½ä»¤ä¼šåˆ é™¤ `assets/template.docx`ï¼Œè¿˜è¯·æ³¨æ„ã€‚

# é¡¹ç›®å®ç°

## å®ç°æ€è·¯è¯´æ˜

åŸè®¡åˆ’æ˜¯ä¾é ä¸€ä»½ Markdown ä¾é  Pandoc å®Œæˆè®ºæ–‡è¾“å‡ºï¼Œç»“æœå‘ç° Pandoc å¯¹ docx çš„è¾“å‡ºæœ‰äº›ä¸€è¨€éš¾å°½ã€‚æ ‡é¢˜ã€ä½œè€…ç­‰å…ƒæ•°æ®æ˜¯ç¡¬ç¼–ç åœ¨æ–‡æ¡£å†…çš„ï¼Œè¿™å¯¹æˆ‘çš„å¤„ç†å·¥ä½œäº§ç”Ÿäº†æå¤§çš„å›°æ‰°ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¼šï¼š

1. é¢„å¤„ç†ï¼šä¸‹è½½æ‰€éœ€çš„ä¾èµ–
2. Pandoc å¤„ç†ï¼šé€šè¿‡ Pandoc ç”Ÿæˆä¸€ä»½ docx æ–‡æ¡£ï¼Œä¾èµ–è‡ªå®šä¹‰çš„ `filter.py` è¿‡æ»¤å™¨
3. åå¤„ç†
    1. ä½¿ç”¨ python-docx åœ¨å°é¢æ’å…¥æ ¡å¾½
    2. è§£åŒ… docx æ–‡æ¡£ï¼Œè§£æ XMLï¼Œåˆ é™¤ç¬¬ä¸€ä¸ª `\newSectionInNewPage` åŠå…¶ä¹‹å‰çš„å…¨éƒ¨å†…å®¹ï¼›ä¿®æ”¹ Word æ–‡æ¡£ç‰ˆå¼è®¾å®šä¸­çš„ å­—ç¬¦é—´è·æ§åˆ¶ - åªå‹ç¼©æ ‡ç‚¹ç¬¦å·ï¼Œè¿™æ›´ç¬¦åˆä¸­æ–‡çš„é»˜è®¤é…ç½®ã€‚

æ¬²äº†è§£æ›´å¤šç»†èŠ‚ï¼Œ è¯·ç§»æ­¥ `processer.py`ã€‚

## æ¨¡æ¿æ–‡ä»¶æ ·å¼è¯´æ˜

æ¨¡æ¿æ–‡ä»¶ä¿å­˜åœ¨ `/assets/template` æ–‡ä»¶å¤¹ä¸­ï¼Œæˆ‘ä»¬çš„ç¨‹åºä¼š Zip æ‰“åŒ…è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶ç”Ÿæˆ `template.docx` ä»¥ä¾› Pandoc ä½¿ç”¨ã€‚è¯¥èŠ‚è§£é‡Šäº† `template.docx` æ¨¡æ¿æ–‡ä»¶å†…çš„å„ç±»æ ·å¼ï¼Œä¸”ç»™å‡ºäº†åœ¨ Markdown ä¸­å¯¹åº”çš„å†™æ³•ã€‚

æœ¬æ¨¡æ¿çš„æ ·å¼ä¸­ï¼Œä¸­æ–‡é‡‡å–é»‘ä½“çš„åœ°æ–¹ï¼Œè¥¿æ–‡å­—ä½“ç»Ÿä¸€é‡‡ç”¨ Arialï¼›ä¸­æ–‡é‡‡å–å®‹ä½“çš„åœ°æ–¹ï¼Œè¥¿æ–‡å­—ä½“ç»Ÿä¸€é‡‡ç”¨ Times New Romanã€‚

ä»¥ä¸‹æ‰€è¿°â€œæ ·å¼â€ï¼Œå‡æ»¡è¶³äº†æ’°å†™è§„èŒƒ[@ShaMenDa]ï¼›å½“æ’°å†™è§„èŒƒæœªåšå‡ºæ˜ç¡®è§„å®šæ—¶ï¼Œåˆ™é‡‡å–æˆ‘ä¸ªäººçš„æ’°å†™ä¹ æƒ¯ä¸æœ¬äººæŒ‡å¯¼è€å¸ˆçš„ä¹ æƒ¯ã€‚

### Title ZH

æ ·å¼ï¼šå°ä¸‰å· Arial å­—ä½“åŠ ç²—ï¼Œå±…ä¸­

å¤‡æ³¨ï¼šä»…éœ€åœ¨å…ƒæ•°æ®ä¸­ä¿®æ”¹å¯¹åº”å­—æ®µï¼Œè‡ªåŠ¨ç”Ÿæˆ

Markdown å¯¹åº”ï¼šæ— ï¼Œé€‚å½“ä½ç½®æ’å…¥ `\abstract`ï¼Œä¿®æ”¹å…ƒæ•°æ®å³å¯è‡ªåŠ¨ç”Ÿæˆä¸­æ–‡æ‘˜è¦

æ’ç‰ˆè§„èŒƒï¼š

- ä¸­æ–‡è®ºæ–‡é¢˜ç›®

### Abstract Title ZH

æ ·å¼ï¼šå››å·é»‘ä½“å¹¶åŠ æ–¹æ‹¬å·

å¤‡æ³¨ï¼šä»…éœ€åœ¨å…ƒæ•°æ®ä¸­ä¿®æ”¹å¯¹åº”å­—æ®µï¼Œè‡ªåŠ¨ç”Ÿæˆ

Markdown å¯¹åº”ï¼šæ— ï¼Œé€‚å½“ä½ç½®æ’å…¥ `\abstract`ï¼Œä¿®æ”¹å…ƒæ•°æ®å³å¯è‡ªåŠ¨ç”Ÿæˆä¸­æ–‡æ‘˜è¦

æ’ç‰ˆè§„èŒƒï¼š

- ä¸­æ–‡æ‘˜è¦æ ‡é¢˜
- ä¸­æ–‡å…³é”®è¯æ ‡é¢˜

### Abstract Content ZH

æ ·å¼ï¼šå°å››å·å®‹ä½“

å¤‡æ³¨ï¼šä»…éœ€åœ¨å…ƒæ•°æ®ä¸­ä¿®æ”¹å¯¹åº”å­—æ®µï¼Œè‡ªåŠ¨ç”Ÿæˆ

Markdown å¯¹åº”ï¼šæ— ï¼Œé€‚å½“ä½ç½®æ’å…¥ `\abstract`ï¼Œä¿®æ”¹å…ƒæ•°æ®å³å¯è‡ªåŠ¨ç”Ÿæˆä¸­æ–‡æ‘˜è¦

æ’ç‰ˆè§„èŒƒï¼š

- ä¸­æ–‡æ‘˜è¦å†…å®¹

### Title EN

æ ·å¼ï¼šå°ä¸‰å· Arial å­—ä½“åŠ ç²—ï¼Œå±…ä¸­

å¤‡æ³¨ï¼šä»…éœ€åœ¨å…ƒæ•°æ®ä¸­ä¿®æ”¹å¯¹åº”å­—æ®µï¼Œè‡ªåŠ¨ç”Ÿæˆ

Markdown å¯¹åº”ï¼šæ— ï¼Œé€‚å½“ä½ç½®æ’å…¥ `\abstractEn`ï¼Œä¿®æ”¹å…ƒæ•°æ®å³å¯è‡ªåŠ¨ç”Ÿæˆè‹±æ–‡æ‘˜è¦

æ’ç‰ˆè§„èŒƒï¼š

- è‹±æ–‡è®ºæ–‡é¢˜ç›®

### Abstract Title EN

æ ·å¼ï¼šå°å››å· Arial å­—ä½“ï¼ŒåŠ ç²—å¹¶åŠ æ–¹æ‹¬å·

å¤‡æ³¨ï¼šä»…éœ€åœ¨å…ƒæ•°æ®ä¸­ä¿®æ”¹å¯¹åº”å­—æ®µï¼Œè‡ªåŠ¨ç”Ÿæˆ

Markdown å¯¹åº”ï¼šæ— ï¼Œé€‚å½“ä½ç½®æ’å…¥ `\abstractEn`ï¼Œä¿®æ”¹å…ƒæ•°æ®å³å¯è‡ªåŠ¨ç”Ÿæˆè‹±æ–‡æ‘˜è¦

æ’ç‰ˆè§„èŒƒï¼š

- è‹±æ–‡æ‘˜è¦æ ‡é¢˜
- è‹±æ–‡å…³é”®è¯æ ‡é¢˜

### Abstract Content EN

æ ·å¼ï¼šäº”å· Arial å­—ä½“

å¤‡æ³¨ï¼šä»…éœ€åœ¨å…ƒæ•°æ®ä¸­ä¿®æ”¹å¯¹åº”å­—æ®µï¼Œè‡ªåŠ¨ç”Ÿæˆ

Markdown å¯¹åº”ï¼šæ— ï¼Œé€‚å½“ä½ç½®æ’å…¥ `\abstractEn`ï¼Œä¿®æ”¹å…ƒæ•°æ®å³å¯è‡ªåŠ¨ç”Ÿæˆä¸­æ–‡æ‘˜è¦

æ’ç‰ˆè§„èŒƒï¼š

- è‹±æ–‡æ‘˜è¦å†…å®¹

### æ ‡é¢˜ 1

æ ·å¼ï¼šå°ä¸‰å·é»‘ä½“

å¤‡æ³¨ï¼šæ’ç‰ˆè§„èŒƒä¸­æœªè¦æ±‚å±…ä¸­ï¼Œä½†å®è·µä¸­éƒ½å±…ä¸­å¤„ç†ã€‚æ•…æ¨¡æ¿äº¦è®¾ç½®ä¸ºå±…ä¸­å¯¹é½

Markdown å¯¹åº”ï¼šä¸€çº§æ ‡é¢˜ï¼ˆH1ï¼‰

æ’ç‰ˆè§„èŒƒï¼š

- ç¬¬ä¸€çº§æ ‡é¢˜

### æ ‡é¢˜ 2

æ ·å¼ï¼šå››å·é»‘ä½“

å¤‡æ³¨ï¼šå·¦å¯¹é½

Markdown å¯¹åº”ï¼šäºŒçº§æ ‡é¢˜ï¼ˆH2ï¼‰

æ’ç‰ˆè§„èŒƒï¼š

- ç¬¬äºŒçº§æ ‡é¢˜

### æ ‡é¢˜ 3-9

æ ·å¼ï¼šå°å››å·å®‹ä½“

å¤‡æ³¨ï¼šå·¦å¯¹é½

Markdown å¯¹åº”ï¼š3-6 çº§æ ‡é¢˜ï¼ˆH3-6ï¼‰

æ’ç‰ˆè§„èŒƒï¼š

- ç¬¬ä¸‰çº§èµ·æ ‡é¢˜

### æ­£æ–‡æ–‡æœ¬ã€First Paragraph

æ ·å¼ï¼šå°å››å·å®‹ä½“ï¼Œæ¯æ®µé¦–è¡Œç¼©è¿› 2 å­—ç¬¦ï¼Œè¡Œé«˜å›ºå®šå€¼ 20 ç£…

å¤‡æ³¨ï¼šæ— 

Markdown å¯¹åº”ï¼šæ®µè½

æ’ç‰ˆè§„èŒƒï¼š

- å¼•è¨€å†…å®¹
- æ­£æ–‡
- ç»“è®ºå†…å®¹
- è‡´è°¢è¯­å†…å®¹
- é™„å½•å†…å®¹

### Introduction Title Like

æ ·å¼ï¼šå››å·é»‘ä½“ï¼Œå±…ä¸­

å¤‡æ³¨ï¼šç”±è¿‡æ»¤å™¨è‡ªåŠ¨å®ç°å¼•è¨€ã€è‡´è°¢ã€å‚è€ƒæ–‡çŒ®çš„â€œå¦èµ·ä¸€é¡µï¼Œæ ‡é¢˜å’Œå†…å®¹ä¹‹é—´ç©ºä¸¤è¡Œâ€ä¹‹æ•ˆæœï¼›é™„å½•åˆ™ä»…åº”ç”¨æ ·å¼

Markdown å¯¹åº”ï¼šä¸€çº§æ ‡é¢˜ï¼ˆH1ï¼‰ã€‚æ ‡é¢˜å†…å®¹ä»…å¯å–å€¼ä¸ºï¼šå¼•è¨€ã€è‡´è°¢ã€è‡´è°¢è¯­ã€å‚è€ƒæ–‡çŒ®ã€é™„å½•

æ’ç‰ˆè§„èŒƒï¼š

- å¼•è¨€
- è‡´è°¢è¯­æ ‡é¢˜
- å‚è€ƒæ–‡çŒ®æ ‡é¢˜
- é™„å½•æ ‡é¢˜

### Conclusion Title

æ ·å¼ï¼šå››å·å®‹ä½“ï¼Œå±…ä¸­

å¤‡æ³¨ï¼š

Markdown å¯¹åº”ï¼šä¸€çº§æ ‡é¢˜ï¼ˆH1ï¼‰ã€‚æ ‡é¢˜å†…å®¹ä»…å¯å–å€¼ä¸ºï¼šç»“è®ºã€æ€»ç»“

æ’ç‰ˆè§„èŒƒï¼š

- ç»“è®ºæ ‡é¢˜

### Reference Content

æ ·å¼ï¼šäº”å·å®‹ä½“ï¼Œå·¦é¡¶æ ¼

å¤‡æ³¨ï¼šç”±è¿‡æ»¤å™¨è‡ªåŠ¨å®ç°â€œäº”å·å®‹ä½“ï¼Œå·¦é¡¶æ ¼â€ä¹‹æ•ˆæœ

Markdown å¯¹åº”ï¼šä¸€çº§æ ‡é¢˜ï¼ˆH1ï¼‰ã€‚æ ‡é¢˜å†…å®¹ä»…å¯å–å€¼ä¸ºï¼šå‚è€ƒæ–‡çŒ®

æ’ç‰ˆè§„èŒƒï¼š

- å‚è€ƒæ–‡çŒ®å†…å®¹

### Table captionã€Image Caption

æ ·å¼ï¼šäº”å·å®‹ä½“ã€Times New Romanï¼Œå±…ä¸­ï¼Œæ®µè½é—´è·ï¼šæ®µå‰: 3 ç£…ã€æ®µå: 3 ç£…

å¤‡æ³¨ï¼šè¯¥æ ·å¼å¹¶æœªåœ¨æ’°å†™è§„èŒƒä¸­è¯¦ç»†æ³¨æ˜ã€‚

Markdown å¯¹åº”ï¼šå‚é˜…[å›¾ç‰‡åŠè‡ªåŠ¨æ ‡å·](#å›¾ç‰‡åŠè‡ªåŠ¨æ ‡å·)ã€[è¡¨æ ¼åŠè‡ªåŠ¨æ ‡å·](#è¡¨æ ¼åŠè‡ªåŠ¨æ ‡å·)

### Table

æ ·å¼ï¼šäº”å·å®‹ä½“ã€Times New Romanï¼Œå±…ä¸­ï¼›æ®µè½é—´è·ï¼šæ®µå: 10 ç£…ï¼›å•å€è¡Œè·ï¼Œå•å…ƒæ ¼å†…å·¦å¯¹é½ï¼›ä¸å…è®¸è·¨é¡µæ–­è¡Œã€æ ‡é¢˜è¡Œåœ¨å„é¡µé¡¶ç«¯é‡å¤å‡ºç°ï¼›å…·ä½“è¡¨ç°ä¸ºâ€œä¸‰çº¿è¡¨â€æ ·å¼

å¤‡æ³¨ï¼šè¯¥æ ·å¼å¹¶æœªåœ¨æ’°å†™è§„èŒƒä¸­è¯¦ç»†æ³¨æ˜ã€‚

Markdown å¯¹åº”ï¼šMarkdown è¡¨æ ¼

### Captioned Figure

æ ·å¼ï¼šäº”å·å®‹ä½“ã€Times New Romanï¼Œå±…ä¸­ï¼›æ®µè½é—´è·ï¼šæ®µå‰: 3 ç£…ã€æ®µå: 3 ç£…ï¼›è¡Œè·æœ€å°å€¼ 20 ç£…

å¤‡æ³¨ï¼šè¯¥æ ·å¼å¹¶æœªåœ¨æ’°å†™è§„èŒƒä¸­è¯¦ç»†æ³¨æ˜ã€‚è¯¥æ ·å¼ä¸ºæ’å…¥å›¾ç‰‡æ‰€ç”¨ã€‚

Markdown å¯¹åº”ï¼šMarkdown å›¾ç‰‡

### è¶…é“¾æ¥

æ ·å¼ï¼šé¢œè‰²è®¾ç½®ä¸ºâ€œè‡ªåŠ¨â€

å¤‡æ³¨ï¼šè¯¥æ ·å¼å¹¶æœªåœ¨æ’°å†™è§„èŒƒä¸­è¯¦ç»†æ³¨æ˜ã€‚

Markdown å¯¹åº”ï¼šMarkdown è¶…é“¾æ¥

### Verbatim Char

æ ·å¼ï¼šConsolasï¼Œå°å››

å¤‡æ³¨ï¼šè¯¥æ ·å¼å¹¶æœªåœ¨æ’°å†™è§„èŒƒä¸­è¯¦ç»†æ³¨æ˜ã€‚ä¸º Markdown è¡Œå†…ä»£ç å—æ‰€ç”¨ã€‚

Markdown å¯¹åº”ï¼šMarkdown è¡Œå†…ä»£ç å—

# æ‹“å±•é˜…è¯»

- [Markdown å†™ä½œï¼ŒPandoc è½¬æ¢ï¼šæˆ‘çš„çº¯æ–‡æœ¬å­¦æœ¯å†™ä½œæµç¨‹]( https://sspai.com/post/64842)
- [å¦‚ä½•ç”¨ Markdown å†™è®ºæ–‡ï¼Ÿ](https://sspai.com/post/43471)
- [zotero æœ¬åœ°å¸¸è§æ’ä»¶é…ç½®](https://www.cnblogs.com/wwyt123/p/16031880.html)ï¼ˆBETTER BIBTEX FOR ZOTERO ä¸­æ–‡æ–‡çŒ® cite key ç¼©çŸ­ï¼‰
- [Office Open XML](http://www.officeopenxml.com)ï¼ŒOpenXML å¿«é€Ÿå…¥é—¨

# ç»“è®º {.unnumbered}

æœ¬æ–‡ä»‹ç»çš„ Markdown æ¨¡æ¿ä¸ç”Ÿæˆæ–¹å¼ï¼Œèƒ½è®©ç”¨æˆ·å¿«æ·ç”Ÿæˆç¬¦åˆæ’ç‰ˆè§„èŒƒçš„æ¯•ä¸šè®ºæ–‡ã€‚æ€»ç»“æ¥è¯´ï¼ŒèŠ‚çº¦æ—¶é—´ã€æ˜“äºä½¿ç”¨ã€‚

# è‡´è°¢ {.unnumbered}

æ„Ÿè°¢ John Gruber å’Œ Aaron Swartz åˆ›é€ äº† Markdownã€‚

æ„Ÿè°¢ John MacFarlane åˆ›é€ äº† Pandocã€‚

æ„Ÿè°¢ Github ä¸Šçš„ tomduck åˆ›é€ äº† pandoc-xnos å¥—ä»¶ã€‚

æ„Ÿè°¢ python-docx é¡¹ç›®ã€‚

# å‚è€ƒæ–‡çŒ® {.unnumbered}

::: {#refs}
:::

# é™„å½• {.unnumbered}

## é™„å½•ä¸€ Zotero ç®€æ˜æ•™ç¨‹ {.unnumbered}

Zotero æ˜¯ä¸€ä¸ªå…è´¹å’Œå¼€æºçš„å‚è€ƒç®¡ç†è½¯ä»¶ï¼Œç”¨äºç®¡ç†ä¹¦ç›®æ•°æ®å’Œç›¸å…³ç ”ç©¶èµ„æ–™ã€‚

è¯·è‡ªè¡Œå‰å¾€[å®˜ç½‘ä¸‹è½½](https://www.zotero.org/download/)å®‰è£…ï¼Œæˆ‘ä»¬ä¹ŸåŒæ—¶å»ºè®®æ‚¨å®‰è£… Zotero Connector æµè§ˆå™¨æ’ä»¶ã€‚

å®Œæˆå®‰è£…åæ‰“å¼€ï¼Œåœ¨â€œæˆ‘çš„æ–‡åº“â€ä¸­å¯ä»¥æ–°å»ºåˆ†ç±»ï¼Œé€‚åº”æ‚¨ä¸åŒçš„è®ºæ–‡å†™ä½œéœ€æ±‚ï¼š

![æ–°å»ºåˆ†ç±»](readme.assets/image-20220402181639642.png)

æ‚¨è¿˜éœ€è¦ä¸‹è½½å®‰è£…ä¸¤ä¸ªæ’ä»¶ï¼š[Better BibTeX](https://github.com/retorquere/zotero-better-bibtex/releases/latest) å’Œ [Jasminum](https://github.com/l0o0/jasminum/releases)ã€‚ä¸‹è½½å®ƒä»¬çš„ xpi æ–‡ä»¶ï¼Œæ‰“å¼€ Zotero -> å·¥å…· -> æ’ä»¶ -> å³ä¸Šå°é½¿è½®å›¾æ ‡ -> Install Add-on From File ... -> é€‰æ‹©ä¸‹è½½å¥½çš„ xpi æ–‡ä»¶è¿›è¡Œå®‰è£…ã€‚

å®‰è£…å®Œæ¯•åï¼Œè¿›å…¥ Zotero -> ç¼–è¾‘ -> é¦–é€‰é¡¹ -> Better BibTeXï¼Œä¿®æ”¹ä¸€ä¸ªæ‚¨èˆ’é€‚çš„ Cination key formatï¼ˆå¦åˆ™ä¸­æ–‡æ–‡çŒ® Citation Key ä¼šè¿‡é•¿ï¼‰ã€‚æˆ‘é€‰ç”¨çš„æ˜¯ï¼š`[Auth:clean][year][Title:select=1,1:nopunct:split-ideographs:select=1,3:clean]`ã€‚

![Better BibTeX é…ç½®](readme.assets/image-20220402182854779.png)

åœ¨çŸ¥ç½‘æœç´¢æ–‡çŒ®ï¼Œè¿›å…¥ç»“æœé¡µã€‚ä»¥ä¸‹æ–‡ä¸ºä¾‹ï¼Œç‚¹å‡»å¼•ç”¨æŒ‰é’®ï¼š

![æœç´¢ä¸€ç¯‡æ–‡æ¡£](readme.assets/image-20220402183115900.png)

å†ç‚¹å‡»æµè§ˆå™¨ä¸­çš„ Zotero Connectorï¼Œä¾¿å¯ä»¥ä¿å­˜æ–‡çŒ®åˆ° Zoteroï¼š

![ä¿å­˜åˆ° Zotero](readme.assets/image-20220402183211884.png)

![æ’å…¥ç»“æœ](readme.assets/image-20220402183404519.png)

å¦‚æœæ‚¨ä¸å¸Œæœ›æœ€åç”Ÿæˆçš„å‚è€ƒæ–‡çŒ®ä¸­å‡ºç°æ–‡çŒ®çš„ç½‘å€ï¼Œè¯·åœ¨å³ä¾§çš„ä¿¡æ¯ä¸­åˆ é™¤ URLï¼›å¦‚è‹¥æ‚¨ä¸å¸Œæœ›å‡ºç°è®¿é—®æ—¥æœŸï¼ŒåŒç†ä¹Ÿè¯·åœ¨å³ä¾§ä¿¡æ¯ä¸­è¿›è¡Œåˆ é™¤ã€‚

åœ¨çŸ¥ç½‘ä¸‹è½½çš„æ–‡çŒ®ä¸Šæ–¹å³é”®ï¼Œå°†ä¸­æ–‡åç§°åˆå¹¶ï¼š

![åˆå¹¶ä¸­æ–‡åç§°](readme.assets/image-20220402183738737.png)

åœ¨å·¦ä¾§â€œæˆ‘çš„æ–‡åº“â€ä¸‹æ–¹çš„ç›®å½•ä¸Šå³é”®ï¼Œç‚¹å‡»â€œå¯¼å‡ºåˆ†ç±»â€ï¼š

![å¯¼å‡ºåˆ†ç±»](readme.assets/image-20220402183817126.png)

![å¯¼å‡ºå¯¹è¯æ¡†](readme.assets/image-20220402190017380.png)

ä¾¿å¯ä¿å­˜ä¸º BibTeX æ ¼å¼çš„ bib æ–‡ä»¶ä»¥ä¾›å¼•æ–‡ä½¿ç”¨ã€‚

âš æ³¨æ„ï¼šè¯·æ³¨æ„å¯¼å‡ºæ ¼å¼æ˜¯ â€œBibTeXâ€ è¿˜æ˜¯ â€œBetter BibTeXâ€ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œâ€œBetter BibTeXâ€å¯èƒ½æ— æ³•è¾¾åˆ°æ‚¨é¢„æœŸçš„å¼•æ–‡ç±»å‹ã€‚
